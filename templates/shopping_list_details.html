{% extends 'base.html' %}

{% block header %}
  <h1>{% block title %}Ostoslistan muokkaus{% endblock %}</h1>
{% endblock %}

{% block content %}

<table>
  <tr>
    <td>
      <form action="/shopping_list" method=get">
        <input type="submit" value="Näytä tallennetut ostoslistat">
      </form>
    </td>
  </tr>
</table>

<br>

<table>
  <tr>
    <td>
      <input type="submit" value="Lisää rivi" form="form_main" formaction="/shopping_list_add_row" >
    </td>
    <td>
      <form action="/item_new_from_shopping_list" method="get">
        <input type="hidden" name="list_id" value="{{ list_id }}">
        <input type="submit" value="Lisää uusi nimike">
      </form>
    </td>
  </tr>
</table>

<br>

<form action="/shopping_list_save" id="form_main" method="post">

{% if default_list != True %}
<table>
  <tr>
    <td>
      <label>Ostoslistan nimi:</label>
    </td>
    <td>
      <input type="text" name="list_name" value="{{list_name}}">
    </td>
  </tr>
</table>
{% endif %}

<br>

  <datalist id="item_names">
    {% for name in item_list %}
      <option>{{ name }}</option>
    {% endfor %}
  </datalist>

  <table>
    <tr>
      <th></th>
      <th></th>
      <th>
        <label>Nimike</label>
      </th>
      <th>
        <label>Määrä</label>
      </th>
    </tr>
    {% for i in range(number_of_rows) %}
      <tr>
        <td>
          <input type="hidden" name="{{i}}_row_id" value={{row_ids[i]}}>
        </td>
        <td>
          <input type="image" src="/static/images/checked.png" alt="Merkitse ostetuksi" width="18" height="18" formaction="/shopping_list_mark_row/{{row_ids[i]}}" title="Merkitse ostetuksi tai poista merkintä" >        </td>
        <td>
          <input type="text" name="{{i}}_row_name" list="item_names" value="{{ row_names[i] }}"
          {% if row_marks[i] == 1 %} style="text-decoration: line-through; color:Gray;" {% endif %} />
        </td>
        <td>
          <input type="text" name="{{i}}_row_amount" value="{{row_amounts[i]}}"
            {% if row_marks[i] == 1 %}style="text-decoration: line-through; color:Gray;"{% endif %} >
        </td>
        <td>
          <input type="image" src="/static/images/delete.png" alt="Poista rivi" width="18" height="18" formaction="/shopping_list_delete_row/{{row_ids[i]}}" title="Poista rivi" >
        </td>
        <td>
          <input type="image" src="/static/images/edit.png" alt="Muokkaa rivin nimikettä" width="18" height="18" formaction="/item_modify_from_shopping_list/{{row_ids[i]}}" title="Muokkaa rivin nimikettä" >
        </td>
      </tr>
    {% endfor %}
  </table>

  <br>
  
  <table>
    <tr>
      <td>
        <input type="hidden" name="list_id" value={{list_id}}>
        <input type="hidden" name="number_of_rows" value={{number_of_rows}}>
        <input type="submit" value="Tallenna">
        </form>
      </td>
      <td>
        <form action="/shopping_list_details/{{list_id}}" method="get">
          <input type="submit" value="Peru tallentamattomat muutokset">
        </form>
      </td>
    </tr>
  </table>

{% endblock %}
